<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/29.5.2 Chrome/142.0.7444.265 Electron/39.6.1 Safari/537.36" version="29.5.2">
  <diagram name="Agent Server Architecture" id="arch-main">
    <mxGraphModel dx="2066" dy="1202" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="server_bg" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=light-dark(#fafafa, #1a1a1a);strokeColor=#666666;strokeWidth=1;arcSize=4;fontColor=#333333;" value="" vertex="1">
          <mxGeometry height="597" width="949" x="122" y="270" as="geometry" />
        </mxCell>
        <mxCell id="5EGFO6IDKafMV1P1bgC--1" connectable="0" parent="1" style="group" value="" vertex="1">
          <mxGeometry height="130" width="195" x="860" y="719" as="geometry" />
        </mxCell>
        <mxCell id="legend_bg" parent="5EGFO6IDKafMV1P1bgC--1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FAFAFA;strokeColor=#CCCCCC;arcSize=8;" value="" vertex="1">
          <mxGeometry height="130" width="195" as="geometry" />
        </mxCell>
        <mxCell id="legend_title" parent="5EGFO6IDKafMV1P1bgC--1" style="text;html=1;align=left;fontSize=11;fillColor=none;strokeColor=none;fontColor=#666;" value="&lt;b&gt;Legend&lt;/b&gt;" vertex="1">
          <mxGeometry height="18" width="60" x="13" y="4" as="geometry" />
        </mxCell>
        <mxCell id="leg1" parent="5EGFO6IDKafMV1P1bgC--1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=9;" value="" vertex="1">
          <mxGeometry height="12" width="18" x="13" y="26" as="geometry" />
        </mxCell>
        <mxCell id="leg1t" parent="5EGFO6IDKafMV1P1bgC--1" style="text;html=1;align=left;fontSize=10;fillColor=none;strokeColor=none;" value="External clients" vertex="1">
          <mxGeometry height="18" width="100" x="38" y="22" as="geometry" />
        </mxCell>
        <mxCell id="leg2" parent="5EGFO6IDKafMV1P1bgC--1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=9;" value="" vertex="1">
          <mxGeometry height="12" width="18" x="13" y="46" as="geometry" />
        </mxCell>
        <mxCell id="leg2t" parent="5EGFO6IDKafMV1P1bgC--1" style="text;html=1;align=left;fontSize=10;fillColor=none;strokeColor=none;" value="API interfaces" vertex="1">
          <mxGeometry height="18" width="100" x="38" y="42" as="geometry" />
        </mxCell>
        <mxCell id="leg3" parent="5EGFO6IDKafMV1P1bgC--1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=9;" value="" vertex="1">
          <mxGeometry height="12" width="18" x="13" y="66" as="geometry" />
        </mxCell>
        <mxCell id="leg3t" parent="5EGFO6IDKafMV1P1bgC--1" style="text;html=1;align=left;fontSize=10;fillColor=none;strokeColor=none;" value="Orchestration / Managers" vertex="1">
          <mxGeometry height="18" width="145" x="38" y="62" as="geometry" />
        </mxCell>
        <mxCell id="leg4" parent="5EGFO6IDKafMV1P1bgC--1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9;" value="" vertex="1">
          <mxGeometry height="12" width="18" x="13" y="86" as="geometry" />
        </mxCell>
        <mxCell id="leg4t" parent="5EGFO6IDKafMV1P1bgC--1" style="text;html=1;align=left;fontSize=10;fillColor=none;strokeColor=none;" value="Processing / Inference" vertex="1">
          <mxGeometry height="18" width="130" x="38" y="82" as="geometry" />
        </mxCell>
        <mxCell id="leg5" parent="5EGFO6IDKafMV1P1bgC--1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=9;" value="" vertex="1">
          <mxGeometry height="12" width="18" x="13" y="106" as="geometry" />
        </mxCell>
        <mxCell id="leg5t" parent="5EGFO6IDKafMV1P1bgC--1" style="text;html=1;align=left;fontSize=10;fillColor=none;strokeColor=none;" value="External services" vertex="1">
          <mxGeometry height="18" width="100" x="38" y="102" as="geometry" />
        </mxCell>
        <mxCell id="title" parent="1" style="text;html=1;fontSize=20;fontStyle=1;align=center;verticalAlign=middle;whiteSpace=wrap;fillColor=none;strokeColor=none;fontColor=#333333;" value="Agent Server Technical Architecture Overview" vertex="1">
          <mxGeometry height="30" width="510" x="341.5" y="84" as="geometry" />
        </mxCell>
        <mxCell id="client_rt" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=13;arcSize=12;" value="&lt;b&gt;Real-time Clients&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:11px&quot;&gt;Browser, Mobile, IoT&lt;br&gt;(via agentClient.js SDK)&lt;/font&gt;" vertex="1">
          <mxGeometry height="75" width="280" x="211" y="150" as="geometry" />
        </mxCell>
        <mxCell id="client_rest" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=13;arcSize=12;" value="&lt;b&gt;OpenAI-compatible Clients&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:11px&quot;&gt;curl, Python/JS OpenAI SDK,&lt;br&gt;LangChain, any REST client&lt;/font&gt;" vertex="1">
          <mxGeometry height="75" width="280" x="711" y="150" as="geometry" />
        </mxCell>
        <mxCell id="server_label" parent="1" style="text;html=1;align=left;verticalAlign=top;whiteSpace=wrap;fillColor=none;strokeColor=none;" value="&lt;b style=&quot;font-size:15px;color:#444&quot;&gt;Agent Server&lt;/b&gt;&amp;nbsp; &lt;font style=&quot;color: light-dark(rgb(97, 97, 97), rgb(237, 237, 237));&quot;&gt;(&lt;font style=&quot;font-size: 12px; color: rgb(136, 136, 136);&quot;&gt;FastAPI + Socket.IO • Port 7701)&lt;/font&gt;&lt;/font&gt;" vertex="1">
          <mxGeometry height="25" width="306" x="443.5" y="285" as="geometry" />
        </mxCell>
        <mxCell id="api_label" parent="1" style="text;html=1;align=left;fontSize=11;fillColor=none;strokeColor=none;" value="&lt;font color=&quot;#82b366&quot;&gt;&lt;b&gt;API Layer&lt;/b&gt;&lt;/font&gt;" vertex="1">
          <mxGeometry height="18" width="80" x="151" y="310" as="geometry" />
        </mxCell>
        <mxCell id="sio" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;arcSize=10;" value="&lt;b&gt;Socket.IO Interface&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Events: Chat &amp;bull; Interrupt&lt;br&gt;JoinSTT / LeaveSTT &amp;bull; JoinTTS / LeaveTTS&lt;br&gt;Emits: ChatChunk &amp;bull; ChatDone &amp;bull; RouterResult&lt;/font&gt;" vertex="1">
          <mxGeometry height="80" width="400" x="151" y="335" as="geometry" />
        </mxCell>
        <mxCell id="rest" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;arcSize=10;" value="&lt;b&gt;OpenAI REST API&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;POST /v1/chat/completions (stream + non-stream)&lt;br&gt;GET /v1/models&lt;br&gt;Bearer token auth &amp;bull; Three-tier param merging&lt;/font&gt;" vertex="1">
          <mxGeometry height="80" width="400" x="651" y="335" as="geometry" />
        </mxCell>
        <mxCell id="orch_label" parent="1" style="text;html=1;align=left;fontSize=11;fillColor=none;strokeColor=none;" value="&lt;font color=&quot;#d6b656&quot;&gt;&lt;b&gt;Orchestration&lt;/b&gt;&lt;/font&gt;" vertex="1">
          <mxGeometry height="18" width="100" x="151" y="428" as="geometry" />
        </mxCell>
        <mxCell id="presets" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;arcSize=12;" value="&lt;b&gt;Agent Presets&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;general &amp;bull; router &amp;bull; topic &amp;bull; ml&lt;br&gt;robot &amp;bull; docbro &amp;bull; floorplan &amp;bull; succint&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="225" x="819" y="455.5" as="geometry" />
        </mxCell>
        <mxCell id="proc_label" parent="1" style="text;html=1;align=left;fontSize=11;fillColor=none;strokeColor=none;" value="&lt;font color=&quot;#9673a6&quot;&gt;&lt;b&gt;Processing&lt;/b&gt;&lt;/font&gt;" vertex="1">
          <mxGeometry height="18" width="80" x="151" y="528" as="geometry" />
        </mxCell>
        <mxCell id="memory" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;arcSize=10;" value="&lt;b&gt;Memory Registry&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;ThreadWindowMemory: rolling window&lt;br&gt;per thread_id &amp;bull; preamble generation&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="260" x="614" y="554" as="geometry" />
        </mxCell>
        <mxCell id="inf_label" parent="1" style="text;html=1;align=left;fontSize=11;fillColor=none;strokeColor=none;" value="&lt;font color=&quot;#7E57C2&quot;&gt;&lt;b&gt;Inference&lt;/b&gt;&lt;/font&gt;" vertex="1">
          <mxGeometry height="18" width="80" x="151" y="628" as="geometry" />
        </mxCell>
        <mxCell id="voice_label" parent="1" style="text;html=1;align=left;fontSize=11;fillColor=none;strokeColor=none;" value="&lt;font color=&quot;#d6b656&quot;&gt;&lt;b&gt;Voice Integration&lt;/b&gt;&lt;/font&gt;" vertex="1">
          <mxGeometry height="18" width="120" x="151" y="734.5" as="geometry" />
        </mxCell>
        <mxCell id="stt_mgr" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;arcSize=12;" value="&lt;b&gt;STT Manager&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Multiplexed connections&lt;br&gt;One link per STT URL, many rooms&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="191" x="145" y="765" as="geometry" />
        </mxCell>
        <mxCell id="tts_mgr" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;arcSize=12;" value="&lt;b&gt;TTS Manager&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Stream text chunks to TTS&lt;br&gt;Voice/speed config &amp;bull; Field extraction&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="210" x="402" y="765" as="geometry" />
        </mxCell>
        <mxCell id="stt_server" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;arcSize=12;" value="&lt;b&gt;STT Server&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Speech-to-Text (:2700)&lt;br&gt;Whisper-based transcription&lt;/font&gt;" vertex="1">
          <mxGeometry height="70" width="191" x="146" y="912" as="geometry" />
        </mxCell>
        <mxCell id="tts_server" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;arcSize=12;" value="&lt;b&gt;TTS Server&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Text-to-Speech (:7700)&lt;br&gt;Voice synthesis &amp;amp; streaming&lt;/font&gt;" vertex="1">
          <mxGeometry height="70" width="210" x="403" y="912" as="geometry" />
        </mxCell>
        <mxCell id="models" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=8;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;" value="&lt;b&gt;GGUF Models&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Qwen 2.5 &amp;bull; Phi-4 &amp;bull; Gemma&lt;br&gt;EuroLLM &amp;bull; SmolLM &amp;bull; Jan Nano&lt;/font&gt;" vertex="1">
          <mxGeometry height="80" width="175" x="1141" y="654.5" as="geometry" />
        </mxCell>
        <mxCell id="configs" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=8;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;" value="&lt;b&gt;Configuration&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;agent_config.json&lt;br&gt;*.agent.json &amp;bull; prompts/*.txt&lt;/font&gt;" vertex="1">
          <mxGeometry height="80" width="175" x="1141" y="448" as="geometry" />
        </mxCell>
        <mxCell id="e1" edge="1" parent="1" source="client_rt" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#6c8ebf;fontSize=10;fontColor=#6c8ebf;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;curved=1;" target="sio" value="WebSocket">
          <mxGeometry relative="1" x="-0.4808" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="e2" edge="1" parent="1" source="client_rest" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#6c8ebf;fontSize=10;fontColor=#6c8ebf;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;curved=1;" target="rest" value="HTTP / SSE">
          <mxGeometry relative="1" x="-0.4808" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="e3" edge="1" parent="1" source="sio" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#AAAAAA;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;" target="session">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e4" edge="1" parent="1" source="sio" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#AAAAAA;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;" target="router">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e5" edge="1" parent="1" source="sio" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#9673a6;strokeWidth=2;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.3;entryY=0;entryDx=0;entryDy=0;curved=1;" target="pool">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e6" edge="1" parent="1" source="rest" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#9673a6;strokeWidth=2;exitX=0.3;exitY=1;exitDx=0;exitDy=0;entryX=0.89;entryY=-0.005;entryDx=0;entryDy=0;curved=1;entryPerimeter=0;" target="pool">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e6b" edge="1" parent="1" source="rest" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#AAAAAA;dashed=1;exitX=0.7;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;" target="presets">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e7" edge="1" parent="1" source="sio" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#AAAAAA;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.3;entryY=0;entryDx=0;entryDy=0;curved=1;" target="memory">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e8" edge="1" parent="1" source="router" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#AAAAAA;dashed=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.583;entryY=0.005;entryDx=0;entryDy=0;curved=1;entryPerimeter=0;" target="pool">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e9" edge="1" parent="1" source="pool" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#7E57C2;strokeWidth=2;exitX=0.59;exitY=0.99;exitDx=0;exitDy=0;entryX=0.4;entryY=0;entryDx=0;entryDy=0;curved=1;exitPerimeter=0;" target="engine">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e10" edge="1" parent="1" source="memory" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#9673a6;dashed=1;fontSize=9;fontColor=#9673a6;exitX=0.3;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;curved=1;" target="engine" value="preamble">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e11" edge="1" parent="1" source="sio" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#AAAAAA;exitX=0.1;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;curved=1;" target="stt_mgr">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e12" edge="1" parent="1" source="sio" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#AAAAAA;exitX=0.884;exitY=0.992;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;exitPerimeter=0;" target="tts_mgr">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e13" edge="1" parent="1" source="stt_mgr" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#b85450;fontSize=10;fontColor=#b85450;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;" target="stt_server" value="Socket.IO">
          <mxGeometry relative="1" x="0.439" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="e14" edge="1" parent="1" source="tts_mgr" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#b85450;fontSize=10;fontColor=#b85450;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;" target="tts_server" value="Socket.IO">
          <mxGeometry relative="1" x="0.439" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="e15" edge="1" parent="1" source="engine" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#d79b00;fontSize=10;fontColor=#d79b00;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;entryPerimeter=0;" target="models" value="load">
          <mxGeometry relative="1" x="0.7493" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="e16" edge="1" parent="1" source="presets" style="rounded=1;orthogonalLoop=1;jetSize=auto;html=1;strokeColor=#d79b00;fontSize=10;fontColor=#d79b00;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;entryPerimeter=0;" target="configs" value="load">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="session" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;arcSize=12;" value="&lt;b&gt;Session State&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Per-client task tracking&lt;br&gt;Cancellation &amp;bull; Locks&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="185" x="158" y="450" as="geometry" />
        </mxCell>
        <mxCell id="engine" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#7E57C2;fontSize=12;arcSize=8;strokeWidth=2;" value="&lt;b&gt;LLM Engine&lt;/b&gt;&amp;nbsp;&amp;nbsp;&lt;font style=&quot;font-size:10px;color:#666&quot;&gt;(llama-cpp-python)&lt;/font&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Streaming inference &amp;bull; Chat template auto-detect &amp;bull; Sampling config&lt;br&gt;System prompt injection &amp;bull; Memory preamble &amp;bull; Cancellation support&lt;/font&gt;" vertex="1">
          <mxGeometry height="75" width="520" x="247" y="657" as="geometry" />
        </mxCell>
        <mxCell id="pool" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;arcSize=10;" value="&lt;b&gt;Worker Pool&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Async queue of N LLM engine instances&lt;br&gt;Acquire / Release via context manager&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="350" x="248" y="554" as="geometry" />
        </mxCell>
        <mxCell id="router" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;arcSize=12;" value="&lt;b&gt;Router Dispatcher&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:10px&quot;&gt;Fire-and-forget intent&lt;br&gt;classification → JSON&lt;/font&gt;" vertex="1">
          <mxGeometry height="65" width="185" x="359" y="450" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
